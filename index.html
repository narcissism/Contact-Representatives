<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Congress Contacts</title>
<style>
body {
  background: white;
  font-family: Arial, sans-serif;
  margin: 40px;
}

h1 { margin-bottom: 20px; }

.member {
  border-bottom: 1px solid #ddd;
  padding: 10px 0;
}

.controls {
  margin-bottom: 20px;
}

button {
  margin-right: 10px;
  padding: 6px 12px;
}
</style>
</head>
<body>

<h1>Current US Congress Members</h1>

<div class="controls">
  <button onclick="sortBy('state')">Sort by State</button>
  <button onclick="sortBy('party')">Sort by Party</button>
  <button onclick="sortBy('chamber')">Sort by Chamber</button>
</div>

<div id="list"></div>

<script>
let members = [];

fetch('members.json')
  .then(r => r.json())
  .then(data => {
    members = data;
    render();
  })
  .catch(err => {
    document.getElementById('list').innerHTML = "Error loading members.json — run the GitHub Action first.";
    console.error(err);
  });

function render() {
  const container = document.getElementById('list');
  container.innerHTML = '';

  members.forEach(m => {
    const div = document.createElement('div');
    div.className = 'member';

    div.innerHTML = `
      <b>${m.name}</b> — ${m.party} — ${m.chamber} — ${m.state}<br>
      ${m.website ? `<a href="${m.website}" target="_blank">Website</a> | ` : ''}
      <a href="tel:2025551111">Call</a> |
      <a href="mailto:rep@example.com">Email</a><br>
      ${m.fec ? `Total Receipts: $${Math.round(m.fec.receipts || 0).toLocaleString()} | PACs: $${Math.round(m.fec.from_pacs || 0).toLocaleString()}` : 'No FEC data'}
    `;

    container.appendChild(div);
  });
}

function sortBy(field) {
  members.sort((a,b) => (a[field] > b[field] ? 1 : -1));
  render();
}
</script>

</body>
</html>
