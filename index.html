<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Congress Contact</title>
<style>
body {
  background: white;
  font-family: Arial, sans-serif;
  margin: 40px;
}

h1 { margin-bottom: 20px; }

.member {
  display: flex;
  gap: 15px;
  border-bottom: 1px solid #ddd;
  padding: 14px 0;
  align-items: flex-start;
}

.member img {
  width: 80px;
  height: 100px;
  object-fit: cover;
  border-radius: 6px;
}

.controls {
  margin-bottom: 20px;
}

button {
  margin-right: 10px;
  padding: 6px 12px;
  cursor: pointer;
}

.info b { font-size: 18px; }

.phone {
  margin-top: 6px;
}

</style>
</head>
<body>

<h1>Current US Congress Members</h1>

<div class="controls">
  <button onclick="sortBy('state')">Sort by State</button>
  <button onclick="sortBy('party')">Sort by Party</button>
  <button onclick="sortBy('chamber')">Sort by Chamber</button>
</div>

<div id="list"></div>

<script>
let members = [];

fetch('members.json')
  .then(r => r.json())
  .then(data => {
    members = data;
    render();
  })
  .catch(err => {
    document.getElementById('list').innerHTML = "members.json not found â€” run GitHub Action.";
    console.error(err);
  });

function render() {
  const container = document.getElementById('list');
  container.innerHTML = '';

  members.forEach(m => {
    const div = document.createElement('div');
    div.className = 'member';

    const zip = m.chamber === 'sen' ? '20510' : '20515';

    div.innerHTML = `
      <img src="${m.photo || ''}" onerror="this.style.display='none'">
      <div class="info">
        <b>${m.name}</b><br>
        ${m.party} â€” ${m.chamber.toUpperCase()} â€” ${m.state}<br>
        DC Office ZIP: ${zip}<br>
        <div class="phone">
          Phone: ${m.phone || 'Not listed'}<br>
          ${m.phone ? `<a href="tel:${m.phone.replace(/[^0-9]/g,'')}">ðŸ“ž Click to Call</a>` : ''}
        </div>
        ${m.website ? `<a href="${m.website}" target="_blank">Official Website</a><br>` : ''}
        ${m.fec ? `Total Receipts: $${Math.round(m.fec.receipts || 0).toLocaleString()} | PACs: $${Math.round(m.fec.pacs || 0).toLocaleString()}` : ''}
      </div>
    `;

    container.appendChild(div);
  });
}

function sortBy(field) {
  members.sort((a,b) => (a[field] > b[field] ? 1 : -1));
  render();
}
</script>

</body>
</html>
